<app-header></app-header>
<section id="main">
    <div class="row">
        <div class="col-md-8">
            <div class="main__block">
                <div align="center" style="margin:30px;">
                    <button class="btn btn-primary" (click)="onPrev()">Prev</button>
                    <span style="width:150px; margin:auto;">{{monthes[month]}}, {{year}}</span>
                    <button class="btn btn-primary" (click)="onNext()">Next</button>
                </div>
                <table class="table table-striped">
                    <thead class="table-dark">
                        <th>Sun</th>
                        <th>Mon</th>
                        <th>Tue</th>
                        <th>Wed</th>
                        <th>Thr</th>
                        <th>Fri</th>
                        <th>Sat</th>
                    </thead>
                    <tr class="table table-primary" *ngFor="let item of createRange(6); let _week=index">
                        <td *ngFor="let _item of createRange(7); let _day=index" (click)="showSchedule(startDate + _week*7 + _day)"> 
                            <div *ngIf="!thisMonthDay(_week*7 + _day)">
                                <div class="inactive_date"><b>{{getExcatDate(startDate + _week*7 + _day)}}</b></div>                                
                            </div>
                            <div *ngIf="thisMonthDay(_week*7 + _day)" >                               
                                <b>{{getExcatDate(startDate + _week*7 + _day)}}</b>
                                <div *ngFor="let _schedule of getScheduleList(startDate, _week*7,_day)">
                                    <span class="name">{{ _schedule.name }}</span>:<span class="content">{{ _schedule.content }}</span>
                                </div>
                                <div *ngIf="showMore(startDate + _week*7 +_day)">
                                    ...
                                </div>    
                            </div>  
                        </td>
                    </tr>               
                </table>
            </div>
        </div>
        <div class="col-md-4">
            <!-- //////////////  Popup Modal -->
            <div class="main__block">
                    <div class=" main__block user__component d-flex flex-column">
                        <div class="user__text">                             
                            
                            <h1>Schedules on {{month}}/{{selectedDay}}/{{year}}</h1>
                        </div>                        
                        <div *ngIf="selectedDaySchedules.length>0">
                            <table class="table table-striped">
                                <thead class="table-danger">
                                    <td>Scheduler</td>
                                    <td>Content</td>
                                    <td></td>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let schedule of selectedDaySchedules; let i=index;" class="table-success">
                                        <td>{{schedule.name}}</td>
                                        <td>{{schedule.content}}</td>
                                        <td><div *ngIf="canDelete(schedule.time)"><button type="button" (click)="deleteSchedule(i)">Delete</button></div></td>
                                    </tr>
                                </tbody>
                                
                            </table>
                        </div>
                        <div *ngIf="selectedDaySchedules.length==0">
                            No schedules yet.
                        </div>
                        <div *ngIf="canCreate()">
                            <button type="button" (click)="openSchedulModal(newScheduleModal)">Add new schedule</button>  
                        </div>
                    </div>
            </div>
        </div>
    </div>
    <ng-template #newScheduleModal let-c="close" let-d="dismiss" class="modal-lg">
            <div class="modal-container" style="width: 800px; background: white;">
                <form class="main__block" [formGroup]="form" (submit)="saveNewSchedule()">
                    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                        <span aria-hidden="true" class="cros">&times;</span>
                    </button>
                    <div class="user__component d-flex flex-column">
                        <div class="user__block">
                            <div class="user__block__header d-flex justify-content-between align-items-center">
                                <div class="user__text">
                                    <p>Create new schedule</p>
                                </div>
                                Notes: <input type="textarea" formControlName="content" id="content">

                            </div>
                            <button>Save</button>
                        </div>                                                               
                    </div>
                </form>
            </div>
        </ng-template>
</section>
